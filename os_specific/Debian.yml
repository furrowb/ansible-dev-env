---
- name: Install git
  become: yes
  apt:
    name: git
    state: present
- name: Install zsh
  become: yes
  apt:
    name: zsh
    state: present
- name: Install vim
  become: yes
  apt:
    name: vim
    state: present
# - name: Check for VSCode
#   command:
#     - dpkg-query -W code
#   register: check_vscode
#   failed_when: check_vscode.rc > 1
#   changed_when: check_vscode.rc == 1
- name: Retrieve VSCode
  get_url:
    url: https://go.microsoft.com/fwlink/?LinkID=760868
    dest: "{{ ansible_env.HOME }}/Downloads/vscode.deb"
  # when: check_vscode.changed
- name: Install VSCode
  become: yes
  apt:
    deb: "{{ ansible_env.HOME }}/Downloads/vscode.deb"
- name: Remove VSCode download
  file:
    path: "{{ ansible_env.HOME }}/Downloads/vscode.deb"
    state: absent